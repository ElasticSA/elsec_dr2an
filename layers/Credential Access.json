{
  "name": "El.Sec. Credential Access",
  "versions": {
    "attack": "9",
    "navigator": "4.5",
    "layer": "4.3"
  },
  "domain": "enterprise-attack",
  "description": "Mapping Elastic Secrity (https://www.elastic.co/security) Detection Rules to MITRE ATT&CK Navigator",
  "filters": {},
  "sorting": 0,
  "layout": {
    "layout": "side",
    "showName": true,
    "showID": true
  },
  "hideDisabled": false,
  "legendItems": [
    {
      "label": "El.Sec. => Elastic Secrity",
      "color": "#bbddff"
    },
    {
      "label": "EQL => Event Query Language",
      "color": "#fa744e"
    },
    {
      "label": "ML => Machine Learning",
      "color": "#0077cc"
    },
    {
      "label": "Q => Query (KQL, Lucene, Elasticsearch DSL)",
      "color": "#54bcb2"
    },
    {
      "label": "TH => Threshold",
      "color": "#fec514"
    }
  ],
  "gradient": {
    "colors": [
      "#bbffdd",
      "#44ff66"
    ],
    "minValue": 0,
    "maxValue": 57
  },
  "showTacticRowBackground": true,
  "tacticRowBackground": "#bbddff",
  "selectTechniquesAcrossTactics": false,
  "selectSubtechniquesWithParent": false,
  "metadata": [
    {
      "name": "Elastic Stack version",
      "value": "8.2.0"
    },
    {
      "name": "Metadata format",
      "value": "<Severity> / <Risk_score>: <Name> [<Rule_type>]"
    },
    {
      "name": "Github project",
      "value": "https://github.com/ElasticSA/elsec_dr2an"
    }
  ],
  "techniques": [
    {
      "techniqueID": "T1539",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "WebProxy Settings Modification [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "WebProxy Settings Modification [Q]"
        }
      ],
      "score": 2
    },
    {
      "techniqueID": "T1003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Dumping Account Hashes via Built-In Commands [Q]"
        },
        {
          "name": "High / 73",
          "value": "Kerberos Cached Credentials Dumping [Q]"
        },
        {
          "name": "High / 73",
          "value": "Dumping Account Hashes via Built-In Commands [Q]"
        },
        {
          "name": "High / 73",
          "value": "Mimikatz Memssp Log File Detected [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Microsoft IIS Connection Strings Decryption [EQL]"
        },
        {
          "name": "High / 73",
          "value": "LSASS Memory Dump Handle Access [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Windows Registry File Creation in SMB Share [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Suspicious Remote Registry Access via SeBackupPrivilege [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Remote Credential Access via Registry [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Microsoft Build Engine Loading Windows Credential Libraries [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Mimikatz Memssp Log File Detected [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Microsoft IIS Connection Strings Decryption [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Microsoft IIS Service Account Password Dumped [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Modification of WDigest Security Provider [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Potential Credential Access via DuplicateHandle in LSASS [EQL]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via LSASS Memory Dump [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via Windows Utilities [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Credential Acquisition via Registry Hive Dumping [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Modification of WDigest Security Provider [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Potential Credential Access via DuplicateHandle in LSASS [EQL]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via LSASS Memory Dump [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "PowerShell Kerberos Ticket Request [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via DCSync [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via Renamed COM+ Services DLL [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential LSASS Clone Creation via PssCaptureSnapShot [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential LSASS Memory Dump via PssCaptureSnapShot [TH]"
        },
        {
          "name": "Med. / 47",
          "value": "Symbolic Link to Shadow Copy Created [EQL]"
        }
      ],
      "score": 31
    },
    {
      "techniqueID": "T1543",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Modification of OpenSSH Binaries [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "Modification of OpenSSH Binaries [Q]"
        },
        {
          "name": "High / 73",
          "value": "Service Creation via Local Kerberos Authentication [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Network Logon Provider Registry Modification [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Network Logon Provider Registry Modification [EQL]"
        }
      ],
      "score": 5
    },
    {
      "techniqueID": "T1556",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Modification of OpenSSH Binaries [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "Modification of OpenSSH Binaries [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "Network Logon Provider Registry Modification [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Network Logon Provider Registry Modification [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Shadow Credentials added to AD Object [Q]"
        }
      ],
      "score": 5
    },
    {
      "techniqueID": "T1558",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Kerberos Cached Credentials Dumping [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Kerberos Attack via Bifrost [Q]"
        },
        {
          "name": "High / 73",
          "value": "Service Creation via Local Kerberos Authentication [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Privilege Escalation via Local Kerberos Relay over LDAP [EQL]"
        },
        {
          "name": "High / 73",
          "value": "User account exposed to Kerberoasting [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "Kerberos Traffic from Unusual Process [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "PowerShell Kerberos Ticket Request [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "Kerberos Pre-authentication Disabled for User [Q]"
        }
      ],
      "score": 8
    },
    {
      "techniqueID": "T1558.003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Kerberos Cached Credentials Dumping [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Kerberos Attack via Bifrost [Q]"
        },
        {
          "name": "High / 73",
          "value": "User account exposed to Kerberoasting [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "PowerShell Kerberos Ticket Request [Q]"
        }
      ],
      "score": 4
    },
    {
      "techniqueID": "T1550",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Kerberos Attack via Bifrost [Q]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1550.003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Kerberos Attack via Bifrost [Q]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1552",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        }
      ],
      "score": 2
    },
    {
      "techniqueID": "T1552.004",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        }
      ],
      "score": 2
    },
    {
      "techniqueID": "T1555",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Access to Keychain Credentials Directories [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Keychain Password Retrieval via Command Line [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Keychain Password Retrieval via Command Line [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Access of Stored Browser Credentials [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Access to Keychain Credentials Directories [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Creation or Modification of Domain Backup DPAPI private key [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        }
      ],
      "score": 9
    },
    {
      "techniqueID": "T1555.001",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Access to Keychain Credentials Directories [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Keychain Password Retrieval via Command Line [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Access to Keychain Credentials Directories [EQL]"
        }
      ],
      "score": 3
    },
    {
      "techniqueID": "T1543.003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Service Creation via Local Kerberos Authentication [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1003.001",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "LSASS Memory Dump Handle Access [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Modification of WDigest Security Provider [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Potential Credential Access via DuplicateHandle in LSASS [EQL]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via LSASS Memory Dump [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via Windows Utilities [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Modification of WDigest Security Provider [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Potential Credential Access via DuplicateHandle in LSASS [EQL]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via LSASS Memory Dump [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Credential Access via Renamed COM+ Services DLL [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential LSASS Clone Creation via PssCaptureSnapShot [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential LSASS Memory Dump via PssCaptureSnapShot [TH]"
        }
      ],
      "score": 13
    },
    {
      "techniqueID": "T1548",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Privilege Escalation via Local Kerberos Relay over LDAP [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1548.002",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Privilege Escalation via Local Kerberos Relay over LDAP [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1003.002",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Windows Registry File Creation in SMB Share [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Suspicious Remote Registry Access via SeBackupPrivilege [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Remote Credential Access via Registry [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Credential Acquisition via Registry Hive Dumping [EQL]"
        }
      ],
      "score": 4
    },
    {
      "techniqueID": "T1021",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Windows Registry File Creation in SMB Share [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Suspicious Remote Registry Access via SeBackupPrivilege [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Potential Remote Credential Access via Registry [EQL]"
        }
      ],
      "score": 3
    },
    {
      "techniqueID": "T1021.002",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Windows Registry File Creation in SMB Share [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1555.003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Keychain Password Retrieval via Command Line [EQL]"
        },
        {
          "name": "High / 73",
          "value": "Access of Stored Browser Credentials [EQL]"
        }
      ],
      "score": 2
    },
    {
      "techniqueID": "T1056",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Prompt for Credentials with OSASCRIPT [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1056.002",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Prompt for Credentials with OSASCRIPT [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1555.004",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        },
        {
          "name": "Med. / 47",
          "value": "Searching for Saved Credentials via VaultCmd [EQL]"
        }
      ],
      "score": 2
    },
    {
      "techniqueID": "T1059",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "PowerShell Kerberos Ticket Request [Q]"
        }
      ],
      "score": 3
    },
    {
      "techniqueID": "T1059.001",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "High / 73",
          "value": "PowerShell MiniDump Script [Q]"
        },
        {
          "name": "Med. / 47",
          "value": "PowerShell Kerberos Ticket Request [Q]"
        }
      ],
      "score": 3
    },
    {
      "techniqueID": "T1003.003",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Credential Access via Windows Utilities [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1003.004",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Credential Acquisition via Registry Hive Dumping [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1003.006",
      "enabled": true,
      "metadata": [
        {
          "name": "High / 73",
          "value": "Potential Credential Access via DCSync [EQL]"
        }
      ],
      "score": 1
    },
    {
      "techniqueID": "T1558.004",
      "enabled": true,
      "metadata": [
        {
          "name": "Med. / 47",
          "value": "Kerberos Pre-authentication Disabled for User [Q]"
        }
      ],
      "score": 1
    }
  ]
}